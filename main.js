!function(){"use strict";var t={d:function(e,s){for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{i:function(){return n},E:function(){return o}});class s{constructor(t,e,s){let{name:i,link:r}=t;this._name=i,this._link=r,this._cardSelector=s,this._handleImageClick=e,this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".card__like-button"),this._cardImage=this._element.querySelector(".card__image"),this._trashButton=this._element.querySelector(".card__trash-button"),this._setEventListeners()}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLike),this._trashButton.addEventListener("click",(()=>this._deleteCard())),this._cardImage.addEventListener("click",(()=>this._handleImageClick({link:this._link,name:this._name})))}_handleLike=()=>{this._likeButton.classList.toggle("card__like-button_active")};_deleteCard(){this._element.remove(),this._element=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._cardImage.src=this._link,this._cardImage.alt=`Photo of ${this._name}`,this._element.querySelector(".card__title").textContent=this._name,this._element}}class i{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=t=>{"Escape"===t.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(t=>{t.target===t.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>this.close()))}}class r extends i{constructor(t,e){super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._formInputs=this._popupForm.querySelectorAll("input"),this._handleFormSubmit=e}_getInputValues(){const t={};return this._formInputs.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset()}))}}const n={formSelector:".modal__form",cardTemplate:"#card-template",modalAddCard:"#modalAddCard",modalProfile:"#modalEdit",profileForm:"#edit__profile__form",modalImage:"#preview_image",imageModalContainer:".preview__container",images:".card",cardList:".cards__list",profileName:".profile__title",profileSubtitle:".profile__subtitle"},o={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input-error",errorClass:"modal__input-error_visible",modalSelector:".modal__form"};class l{constructor(t,e){this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._form=e,this._inputList=this._form.querySelectorAll(this._inputSelector),console.log(this._inputList),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(t){const e=this._form.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)}_hideInputError(t){const e=this._form.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.remove(this._errorClass)}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleInputState(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_checkValidity(t){return!t.validity.valid}_hasInvalidInput=()=>Array.from(this._inputList).some(this._checkValidity);_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this.disableButton(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._toggleInputState(t),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}}const a=document.querySelector(".profile__button"),u=document.querySelector("#profile-title-input"),c=document.querySelector("#profile-subtitle-input"),_=document.querySelector(".profile__card-button"),d=document.forms.formAddCard,m=document.forms.profileForm,h={};(t=>{Array.from(document.querySelectorAll(t.modalSelector)).forEach((e=>{const s=new l(t,e),i=e.getAttribute("name");h[i]=s,s.enableValidation()}))})(o);const p=new class extends i{constructor(t){super({popupSelector:t}),this._image=this._popupElement.querySelector(".preview__image"),this._caption=this._popupElement.querySelector(".preview__caption"),super.setEventListeners()}open(t){this._caption.textContent=t.name,this._image.src=t.link,this._image.alt=`image ${t.name}`,super.open()}}(n.modalImage);function f(t){return new s(t,(t=>{p.open(t)}),"#card-template").getView()}const v=new class{constructor(t,e){let{items:s,renderer:i}=t;this._items=s,this._renderer=i,this._container=document.querySelector(e)}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}}({items:e.initialCards,renderer:t=>{const e=f(t);v.addItem(e)}},n.cardList);v.renderItems(e.initialCards);const b=new r(n.modalAddCard,(t=>{const e=f(t);b.close(),v.addItem(e),h[d.getAttribute("name")].disableButton()}));_.addEventListener("click",(()=>{b.open()})),b.setEventListeners();const S=new class{constructor(t,e){this._name=document.querySelector(t),this._subtitle=document.querySelector(e)}getUserInfo(){return{name:this._name.textContent,subtitle:this._subtitle.textContent}}setUserInfo(t,e){this._name.textContent=t,this._subtitle.textContent=e}}(n.profileName,n.profileSubtitle),E=new r(n.modalProfile,(t=>{let{name:e,subtitle:s}=t;S.setUserInfo(e,s),E.close()}));a.addEventListener("click",(()=>{!function(){const t=S.getUserInfo();u.value=t.name,c.value=t.subtitle,E.open()}(),function(){const t=h[m.getAttribute("name")];t.resetValidation(),t.disableButton()}()})),E.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQ0EsSUFBSUEsRUFBc0IsQ0NBMUJBLEVBQXdCLFNBQVNDLEVBQVNDLEdBQ3pDLElBQUksSUFBSUMsS0FBT0QsRUFDWEYsRUFBb0JJLEVBQUVGLEVBQVlDLEtBQVNILEVBQW9CSSxFQUFFSCxFQUFTRSxJQUM1RUUsT0FBT0MsZUFBZUwsRUFBU0UsRUFBSyxDQUFFSSxZQUFZLEVBQU1DLElBQUtOLEVBQVdDLElBRzNFLEVDUEFILEVBQXdCLFNBQVNTLEVBQUtDLEdBQVEsT0FBT0wsT0FBT00sVUFBVUMsZUFBZUMsS0FBS0osRUFBS0MsRUFBTyxFQ0N0R1YsRUFBd0IsU0FBU0MsR0FDWCxvQkFBWGEsUUFBMEJBLE9BQU9DLGFBQzFDVixPQUFPQyxlQUFlTCxFQUFTYSxPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RYLE9BQU9DLGVBQWVMLEVBQVMsYUFBYyxDQUFFZSxPQUFPLEdBQ3ZELEcsbUVDTmUsTUFBTUMsRUFDbkJDLFdBQUFBLENBQVdDLEVBQWlCQyxFQUFrQkMsR0FBYyxJQUFoRCxLQUFFQyxFQUFJLEtBQUVDLEdBQU1KLEVBQ3hCSyxLQUFLQyxNQUFRSCxFQUNiRSxLQUFLRSxNQUFRSCxFQUNiQyxLQUFLRyxjQUFnQk4sRUFDckJHLEtBQUtJLGtCQUFvQlIsRUFDekJJLEtBQUtLLFNBQVdMLEtBQUtNLGVBQ3JCTixLQUFLTyxZQUFjUCxLQUFLSyxTQUFTRyxjQUFjLHNCQUMvQ1IsS0FBS1MsV0FBYVQsS0FBS0ssU0FBU0csY0FBYyxnQkFDOUNSLEtBQUtVLGFBQWVWLEtBQUtLLFNBQVNHLGNBQWMsdUJBRWhEUixLQUFLVyxvQkFDUCxDQUVBQSxrQkFBQUEsR0FDRVgsS0FBS08sWUFBWUssaUJBQWlCLFFBQVNaLEtBQUthLGFBQ2hEYixLQUFLVSxhQUFhRSxpQkFBaUIsU0FBUyxJQUFNWixLQUFLYyxnQkFDdkRkLEtBQUtTLFdBQVdHLGlCQUFpQixTQUFTLElBQ3hDWixLQUFLSSxrQkFBa0IsQ0FBRUwsS0FBTUMsS0FBS0UsTUFBT0osS0FBTUUsS0FBS0MsU0FFMUQsQ0FFQVksWUFBY0EsS0FDWmIsS0FBS08sWUFBWVEsVUFBVUMsT0FBTywyQkFBMkIsRUFHL0RGLFdBQUFBLEdBQ0VkLEtBQUtLLFNBQVNZLFNBQ2RqQixLQUFLSyxTQUFXLElBQ2xCLENBRUFDLFlBQUFBLEdBQ0UsT0FBT1ksU0FDSlYsY0FBY1IsS0FBS0csZUFDbkJnQixRQUFRWCxjQUFjLFNBQ3RCWSxXQUFVLEVBQ2YsQ0FFQUMsT0FBQUEsR0FJRSxPQUhBckIsS0FBS1MsV0FBV2EsSUFBTXRCLEtBQUtFLE1BQzNCRixLQUFLUyxXQUFXYyxJQUFPLFlBQVd2QixLQUFLQyxRQUN2Q0QsS0FBS0ssU0FBU0csY0FBYyxnQkFBZ0JnQixZQUFjeEIsS0FBS0MsTUFDeERELEtBQUtLLFFBQ2QsRUMzQ2EsTUFBTW9CLEVBQ25CL0IsV0FBQUEsQ0FBV0MsR0FBb0IsSUFBbkIsY0FBRStCLEdBQWUvQixFQUMzQkssS0FBSzJCLGNBQWdCVCxTQUFTVixjQUFja0IsR0FDNUMxQixLQUFLNEIsYUFBZTVCLEtBQUsyQixjQUFjbkIsY0FBYyxnQkFDdkQsQ0FFQXFCLElBQUFBLEdBQ0U3QixLQUFLMkIsY0FBY1osVUFBVWUsSUFBSSxnQkFDakNaLFNBQVNOLGlCQUFpQixVQUFXWixLQUFLK0IsZ0JBQzVDLENBRUFDLEtBQUFBLEdBQ0VoQyxLQUFLMkIsY0FBY1osVUFBVUUsT0FBTyxnQkFDcENDLFNBQVNlLG9CQUFvQixVQUFXakMsS0FBSytCLGdCQUMvQyxDQUVBQSxnQkFBbUJHLElBQ0gsV0FBVkEsRUFBRXZELEtBQ0pxQixLQUFLZ0MsT0FDUCxFQUdGRyxpQkFBQUEsR0FFRW5DLEtBQUsyQixjQUFjZixpQkFBaUIsU0FBVXdCLElBQ3hDQSxFQUFNQyxTQUFXRCxFQUFNRSxlQUN6QnRDLEtBQUtnQyxPQUNQLElBR0ZoQyxLQUFLNEIsYUFBYWhCLGlCQUFpQixTQUFTLElBQU1aLEtBQUtnQyxTQUN6RCxFQzdCYSxNQUFNTyxVQUFzQmQsRUFDekMvQixXQUFBQSxDQUFZZ0MsRUFBZWMsR0FDekJDLE1BQU0sQ0FBRWYsa0JBQ1IxQixLQUFLMEMsV0FBYTFDLEtBQUsyQixjQUFjbkIsY0FBYyxnQkFFbkRSLEtBQUsyQyxZQUFjM0MsS0FBSzBDLFdBQVdFLGlCQUFpQixTQUNwRDVDLEtBQUs2QyxrQkFBb0JMLENBQzNCLENBR0FNLGVBQUFBLEdBRUUsTUFBTUMsRUFBYyxDQUFDLEVBTXJCLE9BSkEvQyxLQUFLMkMsWUFBWUssU0FBU0MsSUFDeEJGLEVBQVlFLEVBQU1uRCxNQUFRbUQsRUFBTXpELEtBQUssSUFHaEN1RCxDQUNULENBRUFaLGlCQUFBQSxHQUVFTSxNQUFNTixvQkFHTm5DLEtBQUswQyxXQUFXOUIsaUJBQWlCLFVBQVd3QixJQUMxQ0EsRUFBTWMsaUJBQ05sRCxLQUFLNkMsa0JBQWtCN0MsS0FBSzhDLG1CQUM1QjlDLEtBQUswQyxXQUFXUyxPQUFPLEdBRTNCLEVDakNLLE1BQU1DLEVBQWUsQ0FDMUJDLGFBQWMsZUFDZEMsYUFBYyxpQkFDZEMsYUFBYyxnQkFDZEMsYUFBYyxhQUNkQyxZQUFhLHVCQUNiQyxXQUFZLGlCQUNaQyxvQkFBcUIsc0JBQ3JCQyxPQUFRLFFBQ1JDLFNBQVUsZUFDVkMsWUFBYSxrQkFDYkMsZ0JBQWlCLHNCQUVOQyxFQUFxQixDQUNoQ0MsY0FBZSxnQkFDZkMscUJBQXNCLGlCQUN0QkMsb0JBQXFCLHlCQUNyQkMsZ0JBQWlCLHFCQUNqQkMsV0FBWSw2QkFDWkMsY0FBZSxnQkNuQkYsTUFBTUMsRUFDbkI3RSxXQUFBQSxDQUFZOEUsRUFBVUMsR0FDcEJ6RSxLQUFLMEUsZUFBaUJGLEVBQVNQLGNBQy9CakUsS0FBSzJFLHNCQUF3QkgsRUFBU04scUJBQ3RDbEUsS0FBSzRFLHFCQUF1QkosRUFBU0wsb0JBQ3JDbkUsS0FBSzZFLGlCQUFtQkwsRUFBU0osZ0JBQ2pDcEUsS0FBSzhFLFlBQWNOLEVBQVNILFdBQzVCckUsS0FBSytFLE1BQVFOLEVBQ2J6RSxLQUFLZ0YsV0FBYWhGLEtBQUsrRSxNQUFNbkMsaUJBQWlCNUMsS0FBSzBFLGdCQUNuRE8sUUFBUUMsSUFBSWxGLEtBQUtnRixZQUNqQmhGLEtBQUttRixjQUFnQm5GLEtBQUsrRSxNQUFNdkUsY0FBY1IsS0FBSzJFLHNCQUNyRCxDQUVBUyxlQUFBQSxDQUFnQkMsR0FFZCxNQUFNQyxFQUFzQnRGLEtBQUsrRSxNQUFNdkUsY0FDcEMsSUFBRzZFLEVBQWFFLFlBR25CRixFQUFhdEUsVUFBVWUsSUFBSTlCLEtBQUs2RSxrQkFFaENTLEVBQW9COUQsWUFBYzZELEVBQWFHLGtCQUUvQ0YsRUFBb0J2RSxVQUFVZSxJQUFJOUIsS0FBSzhFLFlBQ3pDLENBRUFXLGVBQUFBLENBQWdCSixHQUVkLE1BQU1DLEVBQXNCdEYsS0FBSytFLE1BQU12RSxjQUNwQyxJQUFHNkUsRUFBYUUsWUFJbkJGLEVBQWF0RSxVQUFVRSxPQUFPakIsS0FBSzZFLGtCQUduQ1MsRUFBb0I5RCxZQUFjLEdBR2xDOEQsRUFBb0J2RSxVQUFVRSxPQUFPakIsS0FBSzhFLFlBQzVDLENBR0FZLGFBQUFBLEdBQ0UxRixLQUFLbUYsY0FBY3BFLFVBQVVlLElBQUk5QixLQUFLNEUsc0JBRXRDNUUsS0FBS21GLGNBQWNRLFVBQVcsQ0FDaEMsQ0FHQUMsYUFBQUEsR0FDRTVGLEtBQUttRixjQUFjcEUsVUFBVUUsT0FBT2pCLEtBQUs0RSxzQkFDekM1RSxLQUFLbUYsY0FBY1EsVUFBVyxDQUNoQyxDQUdBRSxpQkFBQUEsQ0FBa0JSLEdBQ1hBLEVBQWFTLFNBQVNDLE1BS3pCL0YsS0FBS3lGLGdCQUFnQkosR0FIckJyRixLQUFLb0YsZ0JBQWdCQyxFQUt6QixDQUdBVyxjQUFBQSxDQUFlWCxHQUNiLE9BQVFBLEVBQWFTLFNBQVNDLEtBQ2hDLENBSUFFLGlCQUFtQkEsSUFDakJDLE1BQU1DLEtBQUtuRyxLQUFLZ0YsWUFBWW9CLEtBQUtwRyxLQUFLZ0csZ0JBR3hDSyxrQkFBQUEsR0FFTXJHLEtBQUtpRyxtQkFDUGpHLEtBQUswRixnQkFHTDFGLEtBQUs0RixlQUVULENBR0FqRixrQkFBQUEsR0FFRVgsS0FBSzBGLGdCQUdMMUYsS0FBS2dGLFdBQVdoQyxTQUFTcUMsSUFDdkJBLEVBQWF6RSxpQkFBaUIsU0FBUyxLQUNyQ1osS0FBSzZGLGtCQUFrQlIsR0FDdkJyRixLQUFLcUcsb0JBQW9CLEdBQ3pCLEdBRU4sQ0FHQUMsZ0JBQUFBLEdBQ0V0RyxLQUFLK0UsTUFBTW5FLGlCQUFpQixVQUFXd0IsSUFFckNBLEVBQU1jLGdCQUFnQixJQUl4QmxELEtBQUtXLG9CQUNQLENBRUE0RixlQUFBQSxHQUVFdkcsS0FBS3FHLHFCQUdMckcsS0FBS2dGLFdBQVdoQyxTQUFTcUMsSUFDdkJyRixLQUFLeUYsZ0JBQWdCSixFQUFhLEdBRXRDLEVDMUdGLE1BQU1tQixFQUFhdEYsU0FBU1YsY0FBYyxvQkFDcENpRyxFQUFrQnZGLFNBQVNWLGNBQWMsd0JBQ3pDa0csRUFBcUJ4RixTQUFTVixjQUFjLDJCQUM1Q21HLEVBQWF6RixTQUFTVixjQUFjLHlCQUVwQ29HLEVBQWMxRixTQUFTMkYsTUFBbUIsWUFDMUNwRCxFQUFjdkMsU0FBUzJGLE1BQW1CLFlBTzFDQyxFQUFnQixDQUFDLEVBR0c5QyxLQUVQa0MsTUFBTUMsS0FDckJqRixTQUFTMEIsaUJBQWlCb0IsRUFBbUJNLGdCQUl0Q3RCLFNBQVN5QixJQUVoQixNQUFNc0MsRUFBWSxJQUFJeEMsRUFBY1AsRUFBb0JTLEdBQ2xEdUMsRUFBV3ZDLEVBQVl3QyxhQUFhLFFBRTFDSCxFQUFjRSxHQUFZRCxFQUcxQkEsRUFBVVQsa0JBQWtCLEdBQzVCLEVBRUpBLENBQWlCdEMsR0FNakIsTUFBTWtELEVBQWEsSUNwRFosY0FBNkJ6RixFQUNsQy9CLFdBQUFBLENBQVlnQyxHQUNWZSxNQUFNLENBQUVmLGtCQUNSMUIsS0FBS21ILE9BQVNuSCxLQUFLMkIsY0FBY25CLGNBQWMsbUJBQy9DUixLQUFLb0gsU0FBV3BILEtBQUsyQixjQUFjbkIsY0FBYyxxQkFDakRpQyxNQUFNTixtQkFDUixDQUdBTixJQUFBQSxDQUFLd0YsR0FDSHJILEtBQUtvSCxTQUFTNUYsWUFBYzZGLEVBQVV2SCxLQUN0Q0UsS0FBS21ILE9BQU83RixJQUFNK0YsRUFBVXRILEtBQzVCQyxLQUFLbUgsT0FBTzVGLElBQU8sU0FBUThGLEVBQVV2SCxPQUNyQzJDLE1BQU1aLE1BQ1IsR0RzQ29DdUIsRUFBYU0sWUFLbkQsU0FBUzRELEVBQVdDLEdBUWxCLE9BUGEsSUFBSTlILEVBQ2Y4SCxHQUNDRixJQUNDSCxFQUFXckYsS0FBS3dGLEVBQVUsR0FFNUIsa0JBRVVoRyxTQUNkLENBR0EsTUFBTW1HLEVBQWMsSUV2RUwsTUFDYjlILFdBQUFBLENBQVdDLEVBQXNCOEgsR0FBbUIsSUFBeEMsTUFBRUMsRUFBSyxTQUFFQyxHQUFVaEksRUFDN0JLLEtBQUs0SCxPQUFTRixFQUNkMUgsS0FBSzZILFVBQVlGLEVBQ2pCM0gsS0FBSzhILFdBQWE1RyxTQUFTVixjQUFjaUgsRUFDM0MsQ0FFQU0sV0FBQUEsR0FDRS9ILEtBQUs0SCxPQUFPNUUsU0FBU2dGLElBQ25CaEksS0FBSzZILFVBQVVHLEVBQUssR0FFeEIsQ0FFQUMsT0FBQUEsQ0FBUUMsR0FDTmxJLEtBQUs4SCxXQUFXSyxRQUFRRCxFQUMxQixHRnlEQSxDQUNFUixNQUFPVSxFQUFBQSxhQUNQVCxTQUFXSixJQUVULE1BQU1jLEVBQWNmLEVBQVdDLEdBRy9CQyxFQUFZUyxRQUFRSSxFQUFZLEdBR3BDakYsRUFBYVMsVUFHZjJELEVBQVlPLFlBQVlLLEVBQUFBLGNBT3hCLE1BQU1FLEVBQWUsSUFBSS9GLEVBQWNhLEVBQWFHLGNBQWVnRSxJQUVqRSxNQUFNZ0IsRUFBVWpCLEVBQVdDLEdBRTNCZSxFQUFhdEcsUUFFYndGLEVBQVlTLFFBQVFNLEdBQ3BCekIsRUFBY0YsRUFBWUssYUFBYSxTQUFTdkIsZUFBZSxJQVFqRWlCLEVBQVcvRixpQkFBaUIsU0FBUyxLQUhuQzBILEVBQWF6RyxNQUlDLElBSWhCeUcsRUFBYW5HLG9CQU1iLE1BQU1xRyxFQUFXLElHdEhGLE1BQ2I5SSxXQUFBQSxDQUFZK0ksRUFBY0MsR0FDeEIxSSxLQUFLQyxNQUFRaUIsU0FBU1YsY0FBY2lJLEdBQ3BDekksS0FBSzJJLFVBQVl6SCxTQUFTVixjQUFja0ksRUFDMUMsQ0FFQUUsV0FBQUEsR0FDRSxNQUFPLENBQ0w5SSxLQUFNRSxLQUFLQyxNQUFNdUIsWUFDakJxSCxTQUFVN0ksS0FBSzJJLFVBQVVuSCxZQUU3QixDQUVBc0gsV0FBQUEsQ0FBWWhKLEVBQU0rSSxHQUNoQjdJLEtBQUtDLE1BQU11QixZQUFjMUIsRUFDekJFLEtBQUsySSxVQUFVbkgsWUFBY3FILENBQy9CLEdIdUdBekYsRUFBYVUsWUFDYlYsRUFBYVcsaUJBR1RnRixFQUFlLElBQUl4RyxFQUN2QmEsRUFBYUksY0FDYjdELElBQXdCLElBQXZCLEtBQUVHLEVBQUksU0FBRStJLEdBQVVsSixFQUVqQjZJLEVBQVNNLFlBQVloSixFQUFNK0ksR0FHM0JFLEVBQWEvRyxPQUFPLElBd0J4QndFLEVBQVc1RixpQkFBaUIsU0FBUyxNQWZyQyxXQUNFLE1BQU1vSSxFQUFjUixFQUFTSSxjQUM3Qm5DLEVBQWdCakgsTUFBUXdKLEVBQVlsSixLQUNwQzRHLEVBQW1CbEgsTUFBUXdKLEVBQVlILFNBQ3ZDRSxFQUFhbEgsTUFDZixDQVdFb0gsR0FSRixXQUNFLE1BQU1DLEVBQW1CcEMsRUFBY3JELEVBQVl3RCxhQUFhLFNBQ2hFaUMsRUFBaUIzQyxrQkFDakIyQyxFQUFpQnhELGVBQ25CLENBS0V5RCxFQUFrQixJQUlwQkosRUFBYTVHLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3ByYWN0aWN1bS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb250YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBkZWZpbml0aW9uKSB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgbGluayB9LCBoYW5kbGVJbWFnZUNsaWNrLCBjYXJkU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpOyAvLyBJbml0aWFsaXplIF9lbGVtZW50IG9uY2VcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7IC8vIEluaXRpYWxpemUgX2xpa2VCdXR0b24gb25jZVxyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpOyAvLyBJbml0aWFsaXplIF9jYXJkSW1hZ2Ugb25jZVxyXG4gICAgdGhpcy5fdHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCIpOyAvLyBJbml0aWFsaXplIF90cmFzaEJ1dHRvbiBvbmNlXHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTsgLy8gQ2FsbCBfc2V0RXZlbnRMaXN0ZW5lcnMgb25jZVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZSk7XHJcbiAgICB0aGlzLl90cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5fZGVsZXRlQ2FyZCgpKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IGxpbms6IHRoaXMuX2xpbmssIG5hbWU6IHRoaXMuX25hbWUgfSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZSA9ICgpID0+IHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9O1xyXG5cclxuICBfZGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIHJldHVybiBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IGBQaG90byBvZiAke3RoaXMuX25hbWV9YDtcclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBDbG9zZSB0aGUgcG9wdXAgd2hlbiB1c2VycyBjbGljayBvbiB0aGUgc2hhZGVkIGFyZWEgb3V0c2lkZSB0aGUgbW9kYWxcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGlmIChldmVudC50YXJnZXQgPT09IGV2ZW50LmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcblxyXG4gICAgdGhpcy5fZm9ybUlucHV0cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRcIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIC8vIENvbGxlY3RzIGRhdGEgZnJvbSBhbGwgdGhlIGlucHV0IGZpZWxkcyBhbmQgcmV0dXJucyB0aGUgZGF0YSBhcyBhbiBvYmplY3RcclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAvLyBNYWtlIGEgaW5wdXQgZGF0YSBvYmplY3RcclxuICAgIGNvbnN0IGlucHV0T2JqZWN0ID0ge307XHJcbiAgICAvLyBOYW1lIGVhY2ggaW5wdXQgYnkgaXRzIHZhbHVlXHJcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0T2JqZWN0W2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIC8vIFJldHVybiB0aGUgZGF0YSBhcyBhbiBvYmplY3RcclxuICAgIHJldHVybiBpbnB1dE9iamVjdDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gQWRkIHRoZSAnY2xpY2snIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBjbG9zZSBpY29uXHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgJ3N1Ym1pdCcgZXZlbnQgaGFuZGxlciB0byB0aGUgZm9ybVxyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBmb3JtU2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGNhcmRUZW1wbGF0ZTogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gIG1vZGFsQWRkQ2FyZDogXCIjbW9kYWxBZGRDYXJkXCIsXHJcbiAgbW9kYWxQcm9maWxlOiBcIiNtb2RhbEVkaXRcIixcclxuICBwcm9maWxlRm9ybTogXCIjZWRpdF9fcHJvZmlsZV9fZm9ybVwiLFxyXG4gIG1vZGFsSW1hZ2U6IFwiI3ByZXZpZXdfaW1hZ2VcIixcclxuICBpbWFnZU1vZGFsQ29udGFpbmVyOiBcIi5wcmV2aWV3X19jb250YWluZXJcIixcclxuICBpbWFnZXM6IFwiLmNhcmRcIixcclxuICBjYXJkTGlzdDogXCIuY2FyZHNfX2xpc3RcIixcclxuICBwcm9maWxlTmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBwcm9maWxlU3VidGl0bGU6IFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIsXHJcbn07XHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfdmlzaWJsZVwiLFxyXG4gIG1vZGFsU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMuX2lucHV0TGlzdCk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgLy8gR2VuZXJhdGUgdGhlIGlkIGZvciBlcnJvciBmb3IgdGhlIHRhcmdldCBlbGVtZW50XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICAvLyBBZGQgdGhlIGlucHV0IGVycm9yIGNsYXNzIHRvIHRoZSBlbGVtZW50J3MgY2xhc3MgbGlzdFxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIC8vIENoYW5nZSB0aGUgdGV4dCBjb250ZW50IHRvIHRoZSBlcnJvciBtZXNzYWdlXHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgLy8gQWRkIHRoZSBlcnJvciBjbGFzcyB0byB0aGUgZXJyb3IgbWVzc2FnZSdzIGNsYXNzIGxpc3RcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIC8vIEdlbmVyYXRlIHRoZSBpZCBmb3IgZXJyb3IgZm9yIHRoZSB0YXJnZXQgZWxlbWVudFxyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgaW5wdXQgZXJyb3IgY2xhc3MgdG8gdGhlIGVsZW1lbnQncyBjbGFzcyBsaXN0XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG5cclxuICAgIC8vIENsZWFyIHRoZSBlcnJvciBtZXNzYWdlIGZyb20gdGhlIHRleHQgY29udGVudFxyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBlcnJvciBjbGFzcyB0byB0aGUgZXJyb3IgbWVzc2FnZSdzIGNsYXNzIGxpc3RcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIC8vIERpc2FibGUgZm9ybSBidXR0b25cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8vIEVuYWJsZSBmb3JtIGJ1dHRvblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLy8gU2hvdyBvciBoaWRlIGlucHV0IGVycm9ycyBiYXNlZCBvbiB0aGUgY3VycmVudCBpbnB1dCBlbGVtZW50J3MgdmFsaWRpdHlcclxuICBfdG9nZ2xlSW5wdXRTdGF0ZShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIC8vIElmIGlucHV0IGVsZW1lbnQgaXMgaW52YWxpZCwgc2hvdyBpbnB1dCBlcnJvciBtZXNzYWdlXHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBPdGhlcndpc2UsIGhpZGUgaW5wdXQgZXJyb3IgbWVzc2FnZVxyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQ2hlY2sgaWYgdGhlIGlucHV0IGVsZW1lbnQgaXMgaW52YWxpZFxyXG4gIF9jaGVja1ZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBpZiBhbnkgZWxlbWVudCBpbiB0aGUgaW5wdXQgbGlzdCBpcyBpbnZhbGlkXHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQgPSAoKSA9PlxyXG4gICAgQXJyYXkuZnJvbSh0aGlzLl9pbnB1dExpc3QpLnNvbWUodGhpcy5fY2hlY2tWYWxpZGl0eSk7XHJcblxyXG4gIC8vIFRvZ2dsZSBidXR0b24gZGVwZW5kaW5nIG9uIHRoZSBpbnB1dCdzIHZhbGlkaXR5XHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgLy8gSWYgdGhlIGlucHV0IGlzIHZhbGlkLCBkaXNhYmxlIHRoZSBidXR0b25cclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIE90aGVyd2lzZSwgZW5hYmxlIHRoZSBidXR0b25cclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBTZXQgZXZlbnQgbGlzdGVuZXJzIGZvciBmb3JtIGVsZW1lbnRzIGJhc2VkIG9uIHRoZSB1c2VyIGlucHV0cycgdmFsaWRpdHlcclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBEaXNhYmxlIGJ1dHRvblxyXG4gICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcblxyXG4gICAgLy8gTGlzdGVuIGZvciB0aGUgXCJ0eXBlXCIgZXZlbnQgb24gZWFjaCBpbnB1dFxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl90b2dnbGVJbnB1dFN0YXRlKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFZhbGlkYXRlIGZvcm1cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICAvLyBQcmV2ZW50IHRoZSBmb3JtJ3MgZGVmYXVsdCBiZWhhdmlvdXJcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFNldCBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAvLyBSZXNldCBzdWJtaXQgYnV0dG9uXHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIC8vIENsZWFyIGVycm9yIG1lc3NhZ2VzXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXHJcbiAgZm9ybVNldHRpbmdzLFxyXG4gIGluaXRpYWxDYXJkcyxcclxufSBmcm9tIFwiLi4vdXRpbHMvY29udGFudHMuanNcIjtcclxuXHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuXHJcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvblwiKTtcclxuY29uc3QgbW9kYWxJbnB1dFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5jb25zdCBtb2RhbElucHV0U3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtc3VidGl0bGUtaW5wdXRcIik7XHJcbmNvbnN0IGFkZENhcmRCdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2NhcmQtYnV0dG9uXCIpO1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImZvcm1BZGRDYXJkXCJdO1xyXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZUZvcm1cIl07XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGb3JtIFZhbGlkYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLy8gQ3JlYXRlIGEgZm9ybSB2YWxpZGF0b3JzIG9iamVjdFxyXG5jb25zdCBmb3JtVmFsaWRhdG9yID0ge307XHJcblxyXG4vLyBDcmVhdGUgdmFsaWRhdG9yIGluc3RhbmNlcyBmb3IgYWxsIGZvcm1zXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAodmFsaWRhdGlvblNldHRpbmdzKSA9PiB7XHJcbiAgLy8gQ3JlYXRlIGFuIGFycmF5IG9mIGFsbCBmb3Jtc1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvblNldHRpbmdzLm1vZGFsU2VsZWN0b3IpXHJcbiAgKTtcclxuXHJcbiAgLy8gQ3JlYXRlIGEgdmFsaWRhdG9yIGZvciBlYWNoIGZvcm1cclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgLy8gQ3JlYXRlIGEgdmFsaWRhdG9yIGluc3RhbmNlIGZvciB0aGUgY3VycmVudCBpbnN0YW5jZVxyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcbiAgICAvLyBTdG9yZSB0aGUgY3VycmVudCBmb3JtIHZhbGlkYXRvciBpbiB0aGUgdmFsaWRhdG9ycyBvYmplY3RcclxuICAgIGZvcm1WYWxpZGF0b3JbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG5cclxuICAgIC8vIEVuYWJsZSB2YWxpZGF0aW9uIGZvciB0aGUgY3VycmVudCBmb3JtXHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25TZXR0aW5ncyk7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUG9wdXAgSW1hZ2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vLyBDcmVhdGUgaW1hZ2UgcG9wdXAgaW5zdGFuY2VcclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShmb3JtU2V0dGluZ3MubW9kYWxJbWFnZSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FyZCBTZWN0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBkYXRhLFxyXG4gICAgKGltYWdlRGF0YSkgPT4ge1xyXG4gICAgICBpbWFnZVBvcHVwLm9wZW4oaW1hZ2VEYXRhKTtcclxuICAgIH0sXHJcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCJcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcclxufVxyXG5cclxuLy8gSW5pdGlhbGl6ZSBjYXJkIHNlY3Rpb25cclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgIC8vIENyZWF0ZSBhIG5ldyBjYXJkXHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gcmVuZGVyQ2FyZChkYXRhKTtcclxuXHJcbiAgICAgIC8vIERpc3BsYXkgZWFjaCBjYXJkXHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGZvcm1TZXR0aW5ncy5jYXJkTGlzdFxyXG4pO1xyXG5cclxuY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoaW5pdGlhbENhcmRzKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFkZCBDcmFkICBGb3JtICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vLyBDcmVhdGUgdGhlIGFkZCBmb3JtIGluc3RhbmNlXHJcbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKGZvcm1TZXR0aW5ncy5tb2RhbEFkZENhcmQsIChkYXRhKSA9PiB7XHJcbiAgLy8gQ3JlYXRlIGEgbmV3IGNhcmRcclxuICBjb25zdCBuZXdDYXJkID0gcmVuZGVyQ2FyZChkYXRhKTtcclxuICAvLyBDbG9zZSB0aGUgYWRkIGZvcm1cclxuICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAvLyBBZGQgdGhlIG5ldyBjYXJkIHRvIHRoZSBzZWN0aW9uXHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShuZXdDYXJkKTtcclxuICBmb3JtVmFsaWRhdG9yW2FkZENhcmRGb3JtLmdldEF0dHJpYnV0ZShcIm5hbWVcIildLmRpc2FibGVCdXR0b24oKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBvcGVuQ2FyZEZvcm0oKSB7XHJcbiAgLy8gT3BlbiB0aGUgYWRkIGNhcmQgZm9ybVxyXG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XHJcbn1cclxuLy8gT3BlbiB0aGUgbW9kYWwgd2hlbiB1c2VycyBjbGljayBvbiB0aGUgYWRkIGJ1dHRvblxyXG5hZGRDYXJkQnV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3BlbkNhcmRGb3JtKCk7XHJcbn0pO1xyXG5cclxuLy8gU2V0IGFkZCBmb3JtIGV2ZW50IGxpc3RlbmVyc1xyXG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByb2ZpbGUgSW5mb3JtYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbi8vIENyZWF0ZSB0aGUgdXNlciBpbmZvIGluc3RhbmNlXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxyXG4gIGZvcm1TZXR0aW5ncy5wcm9maWxlTmFtZSxcclxuICBmb3JtU2V0dGluZ3MucHJvZmlsZVN1YnRpdGxlXHJcbik7XHJcbi8vIENyZWF0ZSB0aGUgZWRpdCBmb3JtIGluc3RhbmNlXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIGZvcm1TZXR0aW5ncy5tb2RhbFByb2ZpbGUsXHJcbiAgKHsgbmFtZSwgc3VidGl0bGUgfSkgPT4ge1xyXG4gICAgLy8gQWRkIHRoZSBmb3JtJ3MgaW5wdXQgdG8gdGhlIHByb2ZpbGUgc2VjdGlvblxyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8obmFtZSwgc3VidGl0bGUpO1xyXG5cclxuICAgIC8vIENsb3NlIHRoZSBlZGl0IGZvcm1cclxuICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xyXG4gIH1cclxuKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVkaXQgRm9ybSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vLyBGdW5jdGlvbiB0byBvcGVuIHRoZSBlZGl0IG1vZGFsIGFuZCBwb3B1bGF0ZSBmb3JtIGZpZWxkcyB3aXRoIHByb2ZpbGUgaW5mb1xyXG5mdW5jdGlvbiBvcGVuRWRpdEZvcm0oKSB7XHJcbiAgY29uc3QgcHJvZmlsZUluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIG1vZGFsSW5wdXRUaXRsZS52YWx1ZSA9IHByb2ZpbGVJbmZvLm5hbWU7XHJcbiAgbW9kYWxJbnB1dFN1YnRpdGxlLnZhbHVlID0gcHJvZmlsZUluZm8uc3VidGl0bGU7XHJcbiAgcHJvZmlsZVBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gZGlzYWJsZSBidXR0b25zIGFuZCByZXNldCB2YWxpZGF0aW9uXHJcbmZ1bmN0aW9uIHJlc2V0UHJvZmlsZUZvcm0oKSB7XHJcbiAgY29uc3QgcHJvZmlsZVZhbGlkYXRvciA9IGZvcm1WYWxpZGF0b3JbcHJvZmlsZUZvcm0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKV07XHJcbiAgcHJvZmlsZVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBwcm9maWxlVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcclxufVxyXG5cclxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIGVkaXQgYnV0dG9uIGNsaWNrXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuRWRpdEZvcm0oKTtcclxuICByZXNldFByb2ZpbGVGb3JtKCk7XHJcbn0pO1xyXG5cclxuLy8gU2V0IGV2ZW50IGxpc3RlbmVycyBmb3IgdGhlIHByb2ZpbGUgcG9wdXAgbW9kYWxcclxucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJldmlld19faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJldmlld19fY2FwdGlvblwiKTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICAvLyBEZWZpbmUgb3BlbkltYWdlIGFzIGEgcmVndWxhciBtZXRob2RcclxuICBvcGVuKGltYWdlRGF0YSkge1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IGltYWdlRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gaW1hZ2VEYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBgaW1hZ2UgJHtpbWFnZURhdGEubmFtZX1gO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgc3VidGl0bGVTZWxjdG9yKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHN1YnRpdGxlU2VsY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIHN1YnRpdGxlOiB0aGlzLl9zdWJ0aXRsZS50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhuYW1lLCBzdWJ0aXRsZSkge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9zdWJ0aXRsZS50ZXh0Q29udGVudCA9IHN1YnRpdGxlO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImhhbmRsZUltYWdlQ2xpY2siLCJjYXJkU2VsZWN0b3IiLCJuYW1lIiwibGluayIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2VsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJfbGlrZUJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJfY2FyZEltYWdlIiwiX3RyYXNoQnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlIiwiX2RlbGV0ZUNhcmQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZW1vdmUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZXRWaWV3Iiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwib3BlbiIsImFkZCIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJzZXRFdmVudExpc3RlbmVycyIsImV2ZW50IiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2Zvcm1JbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dE9iamVjdCIsImZvckVhY2giLCJpbnB1dCIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJmb3JtU2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJjYXJkVGVtcGxhdGUiLCJtb2RhbEFkZENhcmQiLCJtb2RhbFByb2ZpbGUiLCJwcm9maWxlRm9ybSIsIm1vZGFsSW1hZ2UiLCJpbWFnZU1vZGFsQ29udGFpbmVyIiwiaW1hZ2VzIiwiY2FyZExpc3QiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVTdWJ0aXRsZSIsInZhbGlkYXRpb25TZXR0aW5ncyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwibW9kYWxTZWxlY3RvciIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0TGlzdCIsImNvbnNvbGUiLCJsb2ciLCJfc3VibWl0QnV0dG9uIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUlucHV0U3RhdGUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrVmFsaWRpdHkiLCJfaGFzSW52YWxpZElucHV0IiwiQXJyYXkiLCJmcm9tIiwic29tZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldFZhbGlkYXRpb24iLCJlZGl0QnV0dG9uIiwibW9kYWxJbnB1dFRpdGxlIiwibW9kYWxJbnB1dFN1YnRpdGxlIiwiYWRkQ2FyZEJ1dCIsImFkZENhcmRGb3JtIiwiZm9ybXMiLCJmb3JtVmFsaWRhdG9yIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJpbWFnZVBvcHVwIiwiX2ltYWdlIiwiX2NhcHRpb24iLCJpbWFnZURhdGEiLCJyZW5kZXJDYXJkIiwiZGF0YSIsImNhcmRTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImluaXRpYWxDYXJkcyIsImNhcmRFbGVtZW50IiwiYWRkQ2FyZFBvcHVwIiwibmV3Q2FyZCIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwic3VidGl0bGVTZWxjdG9yIiwiX3N1YnRpdGxlIiwiZ2V0VXNlckluZm8iLCJzdWJ0aXRsZSIsInNldFVzZXJJbmZvIiwicHJvZmlsZVBvcHVwIiwicHJvZmlsZUluZm8iLCJvcGVuRWRpdEZvcm0iLCJwcm9maWxlVmFsaWRhdG9yIiwicmVzZXRQcm9maWxlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=