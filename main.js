!function(){"use strict";class e{constructor(e){console.log(e.headers),this.baseUrl=e.baseUrl,this.headers=e.headers,console.log(this.headers)}deleteCard(e){return this._request(`${this.baseUrl}/cards/${e}`,{headers:this.headers,method:"DELETE"})}_checkResponse(e){return e.ok?e.json():Promise.reject(e)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this.baseUrl}/cards`,{headers:this.headers})}addCard(e){return this._request(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}"";addLike(e){return this._request(`${this.baseUrl}/cards/likes/${e}`,{headers:this.headers,method:"PUT"})}}class t{constructor(e,t,s){let{name:r,link:i,_id:o}=e;this._name=r,this._link=i,this._cardId=o,this._cardSelector=s,console.log(this._cardId),this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".card__like-button"),this._cardImage=this._element.querySelector(".card__image"),this._trashButton=this._element.querySelector(".card__trash-button")}_addCard(){new e({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"59d50a7d-5cbc-4141-92cc-d4a1e1821930","Content-Type":"application/json"}}).addCard({id:this._cardId,name:this._name,link:this._link}).then((e=>{console.log("Card added successfully:",e)})).catch((e=>{console.error("Error adding card:",e)}))}_handleImageClick(){return this._addCard()}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLike),this._trashButton.addEventListener("click",(()=>this._deleteCard())),this._cardImage.addEventListener("click",(()=>this._handleImageClick()))}_handleLike=()=>{this._likeButton.classList.toggle("card__like-button_active")};_deleteCard(){new e({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"59d50a7d-5cbc-4141-92cc-d4a1e1821930","Content-Type":"application/json"}}).deleteCard(this._cardId).then((()=>{this._element.remove(),this._element=null})).catch((e=>{console.error(e.message)}))}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._setEventListeners(),this._cardImage.src=this._link,this._cardImage.alt=`Photo of ${this._name}`,this._element.querySelector(".card__title").textContent=this._name,this._element}}class s{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>this.close()))}}class i extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._formInputs=this._popupForm.querySelectorAll("input"),this._handleFormSubmit=t}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset()}))}}const o={formSelector:".modal__form",cardTemplate:"#card-template",modalAddCard:"#modalAddCard",modalProfile:"#modalEdit",profileForm:"#edit__profile__form",modalImage:"#preview_image",imageModalContainer:".preview__container",images:".card",cardList:".cards__list",profileAddForm:"#add__card__form",profileName:".profile__title",profileSubtitle:".profile__subtitle",profileAddButton:".profile__card-button"};class n{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputList=this._form.querySelectorAll(this._inputSelector),console.log(this._inputList),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleInputState(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkValidity(e){return!e.validity.valid}_hasInvalidInput=()=>Array.from(this._inputList).some(this._checkValidity);_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this.disableButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputState(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}const a=document.querySelector(".profile__button"),l=document.querySelector("#profile-title-input"),d=document.querySelector("#profile-subtitle-input"),c=(document.querySelector(".profile__card-button"),document.forms.formAddCard,document.forms.profileForm),u=new e({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"59d50a7d-5cbc-4141-92cc-d4a1e1821930","Content-Type":"application/json"}}),h={};var _;let m;function p(e){const s=new t(e,"#card-template",openCardForm);m.addItem(s.getView())}_={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input-error",errorClass:"modal__input-error_visible",modalSelector:".modal__form"},Array.from(document.querySelectorAll(_.modalSelector)).forEach((e=>{const t=new n(_,e),s=e.getAttribute("name");h[s]=t,t.enableValidation()})),new class extends r{constructor(e){super({popupSelector:e}),this._image=this._popupElement.querySelector(".preview__image"),this._caption=this._popupElement.querySelector(".preview__caption"),super.setEventListeners()}open(e){this._caption.textContent=e.name,this._image.src=e.link,this._image.alt=`image ${e.name}`,super.open()}}(o.modalImage),u.getInitialCards().then((e=>{m=new s({items:e,renderer:e=>{p(e)}},".cards__list"),m.renderItems()})).catch((e=>{console.log(e)}));const f=new i(o.modalAddCard,(function(e){u.addCard(e).then((e=>{console.log(e),p(e),o.profileAddForm.reset(),f.close()})).catch((e=>{console.error(e.message)}))}));f.setEventListeners(),o.profileAddButton.addEventListener("click",(function(){f.open()}));const b=new class{constructor(e,t){this._name=document.querySelector(e),this._subtitle=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,subtitle:this._subtitle.textContent}}setUserInfo(e,t){this._name.textContent=e,this._subtitle.textContent=t}}(o.profileName,o.profileSubtitle),v=new i(o.modalProfile,(e=>{let{name:t,subtitle:s}=e;b.setUserInfo(t,s),v.close()}));a.addEventListener("click",(()=>{!function(){const e=b.getUserInfo();l.value=e.name,d.value=e.subtitle,v.open()}(),function(){const e=h[c.getAttribute("name")];e.resetValidation(),e.disableButton()}()})),v.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YXRGLG9CQUViaUIsRUFBYWEsaUJBQWlCcEUsaUJBQWlCLFNBTC9DLFdBQ0U0SCxFQUFhN0YsTUFDZixJQWNBLE1BQU0rRixFQUFXLElFMUhGLE1BQ2JsTCxXQUFBQSxDQUFZbUwsRUFBY0MsR0FDeEIvSyxLQUFLNkIsTUFBUXlCLFNBQVNsQixjQUFjMEksR0FDcEM5SyxLQUFLZ0wsVUFBWTFILFNBQVNsQixjQUFjMkksRUFDMUMsQ0FFQUUsV0FBQUEsR0FDRSxNQUFPLENBQ0w1SixLQUFNckIsS0FBSzZCLE1BQU0rQixZQUNqQnNILFNBQVVsTCxLQUFLZ0wsVUFBVXBILFlBRTdCLENBRUF1SCxXQUFBQSxDQUFZOUosRUFBTTZKLEdBQ2hCbEwsS0FBSzZCLE1BQU0rQixZQUFjdkMsRUFDekJyQixLQUFLZ0wsVUFBVXBILFlBQWNzSCxDQUMvQixHRjJHQTVFLEVBQWFXLFlBQ2JYLEVBQWFZLGlCQUdUa0UsRUFBZSxJQUFJM0YsRUFDdkJhLEVBQWFJLGNBQ2JqRixJQUF3QixJQUF2QixLQUFFSixFQUFJLFNBQUU2SixHQUFVekosRUFFakJvSixFQUFTTSxZQUFZOUosRUFBTTZKLEdBRzNCRSxFQUFhbkcsT0FBTyxJQXdCeEJzRSxFQUFXeEcsaUJBQWlCLFNBQVMsTUFmckMsV0FDRSxNQUFNc0ksRUFBY1IsRUFBU0ksY0FDN0J6QixFQUFnQnJELE1BQVFrRixFQUFZaEssS0FDcENvSSxFQUFtQnRELE1BQVFrRixFQUFZSCxTQUN2Q0UsRUFBYXRHLE1BQ2YsQ0FXRXdHLEdBUkYsV0FDRSxNQUFNQyxFQUFtQjNCLEVBQWNqRCxFQUFZMkQsYUFBYSxTQUNoRWlCLEVBQWlCakMsa0JBQ2pCaUMsRUFBaUI5QyxlQUNuQixDQUtFK0MsRUFBa0IsSUFJcEJKLEVBQWEvRixtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9BUEkvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb250YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIGNvbnNvbGUubG9nKG9wdGlvbnMuaGVhZGVycyk7XHJcbiAgICB0aGlzLmJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLmhlYWRlcnMpO1xyXG4gIH1cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgcmV0dXJuIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMpO1xyXG4gIH1cclxuXHJcbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwgeyBoZWFkZXJzOiB0aGlzLmhlYWRlcnMgfSk7XHJcbiAgICBjb25zb2xlLmxvZyhcIkZldGNoaW5nIGluaXRpYWwgY2FyZHMuLi5cIik7XHJcbiAgfVxyXG4gIC8vICAgX2xvYWREYXRhKCkge1xyXG4gIC8vICAgICByZXR1cm4gdGhpcy5nZXRJbml0aWFsQ2FyZHMoKTtcclxuICAvLyAgIH1cclxuICBhZGRDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lOiBkYXRhLm5hbWUsIGxpbms6IGRhdGEubGluayB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG4gIFwiXCI7XHJcbiAgYWRkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gICB1cGRhdGVBdmF0YXIoKSB7XHJcbiAgLy8gICAgIG1ldGhvZDogXCJQQUNIXCI7XHJcbiAgLy8gICB9XHJcbn1cclxuIiwiaW1wb3J0IEFwaSBmcm9tIFwiLi4vQVBJL0FwaS5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rLCBfaWQgfSwgaGFuZGxlSW1hZ2VDbGljaywgY2FyZFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgdGhpcy5fY2FyZElkID0gX2lkO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgY29uc29sZS5sb2codGhpcy5fY2FyZElkKTtcclxuXHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTsgLy8gSW5pdGlhbGl6ZSBfZWxlbWVudCBvbmNlXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpOyAvLyBJbml0aWFsaXplIF9saWtlQnV0dG9uIG9uY2VcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTsgLy8gSW5pdGlhbGl6ZSBfY2FyZEltYWdlIG9uY2VcclxuICAgIHRoaXMuX3RyYXNoQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWJ1dHRvblwiKTsgLy8gSW5pdGlhbGl6ZSBfdHJhc2hCdXR0b24gb25jZVxyXG5cclxuICAgIC8vIEluc3RhbnRpYXRlIEFwaSBjbGFzc1xyXG4gIH1cclxuICBfYWRkQ2FyZCgpIHtcclxuICAgIGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gICAgICBiYXNlVXJsOiBgaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFgLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI1OWQ1MGE3ZC01Y2JjLTQxNDEtOTJjYy1kNGExZTE4MjE5MzBcIixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgYXBpXHJcbiAgICAgIC5hZGRDYXJkKHsgaWQ6IHRoaXMuX2NhcmRJZCwgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KVxyXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAvLyBIYW5kbGUgdGhlIHJlc3BvbnNlIGlmIG5lZWRlZFxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ2FyZCBhZGRlZCBzdWNjZXNzZnVsbHk6XCIsIHJlc3BvbnNlKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhZGRpbmcgY2FyZDpcIiwgZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbiAgX2hhbmRsZUltYWdlQ2xpY2soKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fYWRkQ2FyZCgpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZSk7XHJcbiAgICB0aGlzLl90cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5fZGVsZXRlQ2FyZCgpKTtcclxuXHJcbiAgICAvLyBGaXggZXZlbnQgbGlzdGVuZXIgZm9yIF9jYXJkSW1hZ2UgY2xpY2tcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlSW1hZ2VDbGljaygpKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH07XHJcblxyXG4gIF9kZWxldGVDYXJkKCkge1xyXG4gICAgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICAgIGJhc2VVcmw6IGBodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MWAsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjU5ZDUwYTdkLTVjYmMtNDE0MS05MmNjLWQ0YTFlMTgyMTkzMFwiLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKHRoaXMuX2NhcmRJZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IGBQaG90byBvZiAke3RoaXMuX25hbWV9YDtcclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBDbG9zZSB0aGUgcG9wdXAgd2hlbiB1c2VycyBjbGljayBvbiB0aGUgc2hhZGVkIGFyZWEgb3V0c2lkZSB0aGUgbW9kYWxcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGlmIChldmVudC50YXJnZXQgPT09IGV2ZW50LmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcblxyXG4gICAgdGhpcy5fZm9ybUlucHV0cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRcIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIC8vIENvbGxlY3RzIGRhdGEgZnJvbSBhbGwgdGhlIGlucHV0IGZpZWxkcyBhbmQgcmV0dXJucyB0aGUgZGF0YSBhcyBhbiBvYmplY3RcclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAvLyBNYWtlIGEgaW5wdXQgZGF0YSBvYmplY3RcclxuICAgIGNvbnN0IGlucHV0T2JqZWN0ID0ge307XHJcbiAgICAvLyBOYW1lIGVhY2ggaW5wdXQgYnkgaXRzIHZhbHVlXHJcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0T2JqZWN0W2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIC8vIFJldHVybiB0aGUgZGF0YSBhcyBhbiBvYmplY3RcclxuICAgIHJldHVybiBpbnB1dE9iamVjdDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gQWRkIHRoZSAnY2xpY2snIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBjbG9zZSBpY29uXHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgJ3N1Ym1pdCcgZXZlbnQgaGFuZGxlciB0byB0aGUgZm9ybVxyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBmb3JtU2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGNhcmRUZW1wbGF0ZTogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gIG1vZGFsQWRkQ2FyZDogXCIjbW9kYWxBZGRDYXJkXCIsXHJcbiAgbW9kYWxQcm9maWxlOiBcIiNtb2RhbEVkaXRcIixcclxuICBwcm9maWxlRm9ybTogXCIjZWRpdF9fcHJvZmlsZV9fZm9ybVwiLFxyXG4gIG1vZGFsSW1hZ2U6IFwiI3ByZXZpZXdfaW1hZ2VcIixcclxuICBpbWFnZU1vZGFsQ29udGFpbmVyOiBcIi5wcmV2aWV3X19jb250YWluZXJcIixcclxuICBpbWFnZXM6IFwiLmNhcmRcIixcclxuICBjYXJkTGlzdDogXCIuY2FyZHNfX2xpc3RcIixcclxuICBwcm9maWxlQWRkRm9ybTogXCIjYWRkX19jYXJkX19mb3JtXCIsXHJcbiAgcHJvZmlsZU5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgcHJvZmlsZVN1YnRpdGxlOiBcIi5wcm9maWxlX19zdWJ0aXRsZVwiLFxyXG4gIHByb2ZpbGVBZGRCdXR0b246IFwiLnByb2ZpbGVfX2NhcmQtYnV0dG9uXCIsXHJcbn07XHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfdmlzaWJsZVwiLFxyXG4gIG1vZGFsU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMuX2lucHV0TGlzdCk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgLy8gR2VuZXJhdGUgdGhlIGlkIGZvciBlcnJvciBmb3IgdGhlIHRhcmdldCBlbGVtZW50XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICAvLyBBZGQgdGhlIGlucHV0IGVycm9yIGNsYXNzIHRvIHRoZSBlbGVtZW50J3MgY2xhc3MgbGlzdFxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIC8vIENoYW5nZSB0aGUgdGV4dCBjb250ZW50IHRvIHRoZSBlcnJvciBtZXNzYWdlXHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgLy8gQWRkIHRoZSBlcnJvciBjbGFzcyB0byB0aGUgZXJyb3IgbWVzc2FnZSdzIGNsYXNzIGxpc3RcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIC8vIEdlbmVyYXRlIHRoZSBpZCBmb3IgZXJyb3IgZm9yIHRoZSB0YXJnZXQgZWxlbWVudFxyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgaW5wdXQgZXJyb3IgY2xhc3MgdG8gdGhlIGVsZW1lbnQncyBjbGFzcyBsaXN0XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG5cclxuICAgIC8vIENsZWFyIHRoZSBlcnJvciBtZXNzYWdlIGZyb20gdGhlIHRleHQgY29udGVudFxyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBlcnJvciBjbGFzcyB0byB0aGUgZXJyb3IgbWVzc2FnZSdzIGNsYXNzIGxpc3RcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIC8vIERpc2FibGUgZm9ybSBidXR0b25cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8vIEVuYWJsZSBmb3JtIGJ1dHRvblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLy8gU2hvdyBvciBoaWRlIGlucHV0IGVycm9ycyBiYXNlZCBvbiB0aGUgY3VycmVudCBpbnB1dCBlbGVtZW50J3MgdmFsaWRpdHlcclxuICBfdG9nZ2xlSW5wdXRTdGF0ZShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIC8vIElmIGlucHV0IGVsZW1lbnQgaXMgaW52YWxpZCwgc2hvdyBpbnB1dCBlcnJvciBtZXNzYWdlXHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBPdGhlcndpc2UsIGhpZGUgaW5wdXQgZXJyb3IgbWVzc2FnZVxyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQ2hlY2sgaWYgdGhlIGlucHV0IGVsZW1lbnQgaXMgaW52YWxpZFxyXG4gIF9jaGVja1ZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBpZiBhbnkgZWxlbWVudCBpbiB0aGUgaW5wdXQgbGlzdCBpcyBpbnZhbGlkXHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQgPSAoKSA9PlxyXG4gICAgQXJyYXkuZnJvbSh0aGlzLl9pbnB1dExpc3QpLnNvbWUodGhpcy5fY2hlY2tWYWxpZGl0eSk7XHJcblxyXG4gIC8vIFRvZ2dsZSBidXR0b24gZGVwZW5kaW5nIG9uIHRoZSBpbnB1dCdzIHZhbGlkaXR5XHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgLy8gSWYgdGhlIGlucHV0IGlzIHZhbGlkLCBkaXNhYmxlIHRoZSBidXR0b25cclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIE90aGVyd2lzZSwgZW5hYmxlIHRoZSBidXR0b25cclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBTZXQgZXZlbnQgbGlzdGVuZXJzIGZvciBmb3JtIGVsZW1lbnRzIGJhc2VkIG9uIHRoZSB1c2VyIGlucHV0cycgdmFsaWRpdHlcclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBEaXNhYmxlIGJ1dHRvblxyXG4gICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcblxyXG4gICAgLy8gTGlzdGVuIGZvciB0aGUgXCJ0eXBlXCIgZXZlbnQgb24gZWFjaCBpbnB1dFxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl90b2dnbGVJbnB1dFN0YXRlKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFZhbGlkYXRlIGZvcm1cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICAvLyBQcmV2ZW50IHRoZSBmb3JtJ3MgZGVmYXVsdCBiZWhhdmlvdXJcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFNldCBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAvLyBSZXNldCBzdWJtaXQgYnV0dG9uXHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIC8vIENsZWFyIGVycm9yIG1lc3NhZ2VzXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IEFwaSBmcm9tIFwiLi4vQVBJL0FwaS5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyB2YWxpZGF0aW9uU2V0dGluZ3MsIGZvcm1TZXR0aW5ncyB9IGZyb20gXCIuLi91dGlscy9jb250YW50cy5qc1wiO1xyXG5cclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5cclxuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uXCIpO1xyXG5jb25zdCBtb2RhbElucHV0VGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XHJcbmNvbnN0IG1vZGFsSW5wdXRTdWJ0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1zdWJ0aXRsZS1pbnB1dFwiKTtcclxuY29uc3QgYWRkQ2FyZEJ1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fY2FyZC1idXR0b25cIik7XHJcblxyXG5jb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZm9ybUFkZENhcmRcIl07XHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlRm9ybVwiXTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjU5ZDUwYTdkLTVjYmMtNDE0MS05MmNjLWQ0YTFlMTgyMTkzMFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGb3JtIFZhbGlkYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLy8gQ3JlYXRlIGEgZm9ybSB2YWxpZGF0b3JzIG9iamVjdFxyXG5jb25zdCBmb3JtVmFsaWRhdG9yID0ge307XHJcblxyXG4vLyBDcmVhdGUgdmFsaWRhdG9yIGluc3RhbmNlcyBmb3IgYWxsIGZvcm1zXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAodmFsaWRhdGlvblNldHRpbmdzKSA9PiB7XHJcbiAgLy8gQ3JlYXRlIGFuIGFycmF5IG9mIGFsbCBmb3Jtc1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvblNldHRpbmdzLm1vZGFsU2VsZWN0b3IpXHJcbiAgKTtcclxuXHJcbiAgLy8gQ3JlYXRlIGEgdmFsaWRhdG9yIGZvciBlYWNoIGZvcm1cclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgLy8gQ3JlYXRlIGEgdmFsaWRhdG9yIGluc3RhbmNlIGZvciB0aGUgY3VycmVudCBpbnN0YW5jZVxyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcbiAgICAvLyBTdG9yZSB0aGUgY3VycmVudCBmb3JtIHZhbGlkYXRvciBpbiB0aGUgdmFsaWRhdG9ycyBvYmplY3RcclxuICAgIGZvcm1WYWxpZGF0b3JbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG5cclxuICAgIC8vIEVuYWJsZSB2YWxpZGF0aW9uIGZvciB0aGUgY3VycmVudCBmb3JtXHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25TZXR0aW5ncyk7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUG9wdXAgSW1hZ2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vLyBDcmVhdGUgaW1hZ2UgcG9wdXAgaW5zdGFuY2VcclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShmb3JtU2V0dGluZ3MubW9kYWxJbWFnZSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FyZCBTZWN0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vLyBQb3N0IGluaXRpYWwgY2FyZHNcclxubGV0IHNlY3Rpb247XHJcbmFwaVxyXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiByZXMsXHJcbiAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgICBjcmVhdGVDYXJkKGRhdGEpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIFwiLmNhcmRzX19saXN0XCJcclxuICAgICk7XHJcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KTtcclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgXCIjY2FyZC10ZW1wbGF0ZVwiLCBvcGVuQ2FyZEZvcm0pO1xyXG4gIHNlY3Rpb24uYWRkSXRlbShjYXJkLmdldFZpZXcoKSk7XHJcbn1cclxuZnVuY3Rpb24gcG9zdEluaXRpYWxDYXJkKHZhbHVlcykge1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQodmFsdWVzKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICBjcmVhdGVDYXJkKHJlcyk7XHJcbiAgICAgIGZvcm1TZXR0aW5ncy5wcm9maWxlQWRkRm9ybS5yZXNldCgpO1xyXG4gICAgICBhZGRDYXJkTW9kYWwuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IubWVzc2FnZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuY29uc3QgYWRkQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgZm9ybVNldHRpbmdzLm1vZGFsQWRkQ2FyZCxcclxuICBwb3N0SW5pdGlhbENhcmRcclxuKTtcclxuXHJcbmZ1bmN0aW9uIG9wZW5BZGRNb2RhbCgpIHtcclxuICBhZGRDYXJkTW9kYWwub3BlbigpO1xyXG59XHJcbmFkZENhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZm9ybVNldHRpbmdzLnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5BZGRNb2RhbCk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZGQgQ3JhZCAgRm9ybSAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByb2ZpbGUgSW5mb3JtYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbi8vIENyZWF0ZSB0aGUgdXNlciBpbmZvIGluc3RhbmNlXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxyXG4gIGZvcm1TZXR0aW5ncy5wcm9maWxlTmFtZSxcclxuICBmb3JtU2V0dGluZ3MucHJvZmlsZVN1YnRpdGxlXHJcbik7XHJcbi8vIENyZWF0ZSB0aGUgZWRpdCBmb3JtIGluc3RhbmNlXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIGZvcm1TZXR0aW5ncy5tb2RhbFByb2ZpbGUsXHJcbiAgKHsgbmFtZSwgc3VidGl0bGUgfSkgPT4ge1xyXG4gICAgLy8gQWRkIHRoZSBmb3JtJ3MgaW5wdXQgdG8gdGhlIHByb2ZpbGUgc2VjdGlvblxyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8obmFtZSwgc3VidGl0bGUpO1xyXG5cclxuICAgIC8vIENsb3NlIHRoZSBlZGl0IGZvcm1cclxuICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xyXG4gIH1cclxuKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVkaXQgRm9ybSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vLyBGdW5jdGlvbiB0byBvcGVuIHRoZSBlZGl0IG1vZGFsIGFuZCBwb3B1bGF0ZSBmb3JtIGZpZWxkcyB3aXRoIHByb2ZpbGUgaW5mb1xyXG5mdW5jdGlvbiBvcGVuRWRpdEZvcm0oKSB7XHJcbiAgY29uc3QgcHJvZmlsZUluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIG1vZGFsSW5wdXRUaXRsZS52YWx1ZSA9IHByb2ZpbGVJbmZvLm5hbWU7XHJcbiAgbW9kYWxJbnB1dFN1YnRpdGxlLnZhbHVlID0gcHJvZmlsZUluZm8uc3VidGl0bGU7XHJcbiAgcHJvZmlsZVBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gZGlzYWJsZSBidXR0b25zIGFuZCByZXNldCB2YWxpZGF0aW9uXHJcbmZ1bmN0aW9uIHJlc2V0UHJvZmlsZUZvcm0oKSB7XHJcbiAgY29uc3QgcHJvZmlsZVZhbGlkYXRvciA9IGZvcm1WYWxpZGF0b3JbcHJvZmlsZUZvcm0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKV07XHJcbiAgcHJvZmlsZVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBwcm9maWxlVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcclxufVxyXG5cclxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIGVkaXQgYnV0dG9uIGNsaWNrXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuRWRpdEZvcm0oKTtcclxuICByZXNldFByb2ZpbGVGb3JtKCk7XHJcbn0pO1xyXG5cclxuLy8gU2V0IGV2ZW50IGxpc3RlbmVycyBmb3IgdGhlIHByb2ZpbGUgcG9wdXAgbW9kYWxcclxucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJldmlld19faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJldmlld19fY2FwdGlvblwiKTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICAvLyBEZWZpbmUgb3BlbkltYWdlIGFzIGEgcmVndWxhciBtZXRob2RcclxuICBvcGVuKGltYWdlRGF0YSkge1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IGltYWdlRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gaW1hZ2VEYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBgaW1hZ2UgJHtpbWFnZURhdGEubmFtZX1gO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBzdWJ0aXRsZVNlbGN0b3IpIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9zdWJ0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VidGl0bGVTZWxjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgc3VidGl0bGU6IHRoaXMuX3N1YnRpdGxlLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5hbWUsIHN1YnRpdGxlKSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX3N1YnRpdGxlLnRleHRDb250ZW50ID0gc3VidGl0bGU7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJBcGkiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJjb25zb2xlIiwibG9nIiwiaGVhZGVycyIsInRoaXMiLCJiYXNlVXJsIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsIl9yZXF1ZXN0IiwibWV0aG9kIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwidXJsIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0SW5pdGlhbENhcmRzIiwiYWRkQ2FyZCIsImRhdGEiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm5hbWUiLCJsaW5rIiwiYWRkTGlrZSIsIkNhcmQiLCJfcmVmIiwiaGFuZGxlSW1hZ2VDbGljayIsImNhcmRTZWxlY3RvciIsIl9pZCIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZElkIiwiX2NhcmRTZWxlY3RvciIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX2xpa2VCdXR0b24iLCJxdWVyeVNlbGVjdG9yIiwiX2NhcmRJbWFnZSIsIl90cmFzaEJ1dHRvbiIsIl9hZGRDYXJkIiwiYXV0aG9yaXphdGlvbiIsImlkIiwicmVzcG9uc2UiLCJjYXRjaCIsImVycm9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2UiLCJfZGVsZXRlQ2FyZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsIm1lc3NhZ2UiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZXRWaWV3Iiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiZm9yRWFjaCIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwib3BlbiIsImFkZCIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsImV2ZW50IiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2Zvcm1JbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dE9iamVjdCIsImlucHV0IiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0IiwiZm9ybVNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiY2FyZFRlbXBsYXRlIiwibW9kYWxBZGRDYXJkIiwibW9kYWxQcm9maWxlIiwicHJvZmlsZUZvcm0iLCJtb2RhbEltYWdlIiwiaW1hZ2VNb2RhbENvbnRhaW5lciIsImltYWdlcyIsImNhcmRMaXN0IiwicHJvZmlsZUFkZEZvcm0iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVTdWJ0aXRsZSIsInByb2ZpbGVBZGRCdXR0b24iLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUlucHV0U3RhdGUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrVmFsaWRpdHkiLCJfaGFzSW52YWxpZElucHV0IiwiQXJyYXkiLCJmcm9tIiwic29tZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldFZhbGlkYXRpb24iLCJlZGl0QnV0dG9uIiwibW9kYWxJbnB1dFRpdGxlIiwibW9kYWxJbnB1dFN1YnRpdGxlIiwiZm9ybXMiLCJhcGkiLCJmb3JtVmFsaWRhdG9yIiwidmFsaWRhdGlvblNldHRpbmdzIiwic2VjdGlvbiIsImNyZWF0ZUNhcmQiLCJjYXJkRGF0YSIsImNhcmQiLCJvcGVuQ2FyZEZvcm0iLCJtb2RhbFNlbGVjdG9yIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJfaW1hZ2UiLCJfY2FwdGlvbiIsImltYWdlRGF0YSIsImVyciIsImFkZENhcmRNb2RhbCIsInZhbHVlcyIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwic3VidGl0bGVTZWxjdG9yIiwiX3N1YnRpdGxlIiwiZ2V0VXNlckluZm8iLCJzdWJ0aXRsZSIsInNldFVzZXJJbmZvIiwicHJvZmlsZVBvcHVwIiwicHJvZmlsZUluZm8iLCJvcGVuRWRpdEZvcm0iLCJwcm9maWxlVmFsaWRhdG9yIiwicmVzZXRQcm9maWxlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=