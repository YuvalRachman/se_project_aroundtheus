!function(){"use strict";[{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"},{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"}].forEach((t=>{const e={name:t.name,link:t.link},s={method:"POST",headers:{authorization:"59d50a7d-5cbc-4141-92cc-d4a1e1821930","Content-Type":"application/json"},body:JSON.stringify(e)};fetch("https://around-api.en.tripleten-services.com/v1/cards",s).then((t=>t.ok?t.json():t.json().then((t=>{throw new Error(t.message)})))).then((t=>{console.log("Card posted successfully:",t)})).catch((t=>{console.error("Failed to post card:",t)}))}));class t{constructor(t,e,s){let{name:n,link:r}=t;this._name=n,this._link=r,this._cardSelector=s,this._handleImageClick=e,this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".card__like-button"),this._cardImage=this._element.querySelector(".card__image"),this._trashButton=this._element.querySelector(".card__trash-button"),this._setEventListeners()}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLike),this._trashButton.addEventListener("click",(()=>this._deleteCard())),this._cardImage.addEventListener("click",(()=>this._handleImageClick({link:this._link,name:this._name})))}_handleLike=()=>{this._likeButton.classList.toggle("card__like-button_active")};_deleteCard(){this._element.remove(),this._element=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._cardImage.src=this._link,this._cardImage.alt=`Photo of ${this._name}`,this._element.querySelector(".card__title").textContent=this._name,this._element}}class e{constructor(t,e){let{items:s,renderer:n}=t;this._items=s,this._renderer=n,this._container=document.querySelector(e)}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}}class s{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=t=>{"Escape"===t.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(t=>{t.target===t.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>this.close()))}}class n extends s{constructor(t,e){super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._formInputs=this._popupForm.querySelectorAll("input"),this._handleFormSubmit=e}_getInputValues(){const t={};return this._formInputs.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset()}))}}class r{constructor(t,e){this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._form=e,this._inputList=this._form.querySelectorAll(this._inputSelector),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(t){const e=this._form.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)}_hideInputError(t){const e=this._form.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.remove(this._errorClass)}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleInputState(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_checkValidity(t){return!t.validity.valid}_hasInvalidInput=()=>Array.from(this._inputList).some(this._checkValidity);_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this.disableButton(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._toggleInputState(t),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}}const i=document.querySelector(".profile__button"),o=document.querySelector("#profile-title-input"),a=document.querySelector("#profile-subtitle-input"),l=document.querySelector(".profile__card-button"),c=document.forms.formAddCard,u=document.forms.profileForm,h=new class{constructor(t){console.log(t.headers),this.baseUrl=t.baseUrl,this.headers=t.headers,console.log(this.headers)}_checkResponse(t){return t.ok?t.json():Promise.reject(`Error: ${t.status}`)}_request(t,e){return fetch(t,e).then(this._checkResponse)}getInitialCards(){return this._request(`${this.baseUrl}/cards`,{headers:this.headers})}_loadData(){return this.getInitialCards()}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"59d50a7d-5cbc-4141-92cc-d4a1e1821930","Content-Type":"application/json"}}),d={};var _;_={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input-error",errorClass:"modal__input-error_visible",modalSelector:".modal__form"},Array.from(document.querySelectorAll(_.modalSelector)).forEach((t=>{const e=new r(_,t),s=t.getAttribute("name");d[s]=e,e.enableValidation()}));const m=new class extends s{constructor(t){super({popupSelector:t}),this._image=this._popupElement.querySelector(".preview__image"),this._caption=this._popupElement.querySelector(".preview__caption"),super.setEventListeners()}open(t){this._caption.textContent=t.name,this._image.src=t.link,this._image.alt=`image ${t.name}`,super.open()}}("#preview_image");function p(e){return new t(e,(t=>{m.open(t)}),"#card-template").getView()}let g;h.getInitialCards().then((t=>{g=new e({items:t,renderer:t=>{g.addItem(p(t))}},".cards"),g.renderItems()})).catch((t=>{console.error("Error fetching initial cards:",t)}));const v=new n("#modalAddCard",(t=>{const e=p(t);v.close(),g.addItem(e),d[c.getAttribute("name")].disableButton()}));l.addEventListener("click",(()=>{v.open()})),v.setEventListeners();const E=new class{constructor(t,e){this._name=document.querySelector(t),this._subtitle=document.querySelector(e)}getUserInfo(){return{name:this._name.textContent,subtitle:this._subtitle.textContent}}setUserInfo(t,e){this._name.textContent=t,this._subtitle.textContent=e}}(".profile__title",".profile__subtitle"),b=new n("#modalEdit",(t=>{let{name:e,subtitle:s}=t;E.setUserInfo(e,s),b.close()}));i.addEventListener("click",(()=>{!function(){const t=E.getUserInfo();o.value=t.name,a.value=t.subtitle,b.open()}(),function(){const t=d[u.getAttribute("name")];t.resetValidation(),t.disableButton()}()})),b.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzdCckMsRUFBZ0J4QyxNQUFRaUYsRUFBWTVLLEtBQ3BDb0ksRUFBbUJ6QyxNQUFRaUYsRUFBWUgsU0FDdkNFLEVBQWFyRyxNQUNmLENBV0V1RyxHQVJGLFdBQ0UsTUFBTUMsRUFBbUIzQixFQUFjWCxFQUFZZ0IsYUFBYSxTQUNoRXNCLEVBQWlCN0Msa0JBQ2pCNkMsRUFBaUIxRCxlQUNuQixDQUtFMkQsRUFBa0IsSUFJcEJKLEVBQWE5RixtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9BUEkvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb250YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIGNvbnNvbGUubG9nKG9wdGlvbnMuaGVhZGVycyk7XHJcbiAgICB0aGlzLmJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLmhlYWRlcnMpO1xyXG4gIH1cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuaGVhZGVycyB9KTtcclxuICB9XHJcbiAgX2xvYWREYXRhKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5jb25zdCB1cmwgPSBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzXCI7XHJcblxyXG4vLyBJdGVyYXRlIG92ZXIgZWFjaCBjYXJkIG9iamVjdCBpbiB0aGUgaW5pdGlhbENhcmRzIGFycmF5XHJcbmluaXRpYWxDYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgLy8gRGVmaW5lIHRoZSByZXF1ZXN0IHBheWxvYWRcclxuICBjb25zdCBwYXlsb2FkID0ge1xyXG4gICAgbmFtZTogY2FyZC5uYW1lLFxyXG4gICAgbGluazogY2FyZC5saW5rLFxyXG4gIH07XHJcblxyXG4gIC8vIERlZmluZSByZXF1ZXN0IG9wdGlvbnNcclxuICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogXCI1OWQ1MGE3ZC01Y2JjLTQxNDEtOTJjYy1kNGExZTE4MjE5MzBcIixcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICB9LFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksIC8vIENvbnZlcnQgcGF5bG9hZCB0byBKU09OIHN0cmluZ1xyXG4gIH07XHJcblxyXG4gIC8vIFBlcmZvcm0gdGhlIFBPU1QgcmVxdWVzdCBmb3IgZWFjaCBjYXJkXHJcbiAgZmV0Y2godXJsLCBvcHRpb25zKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAvLyBDaGVjayBpZiB0aGUgcmVxdWVzdCB3YXMgc3VjY2Vzc2Z1bCAoc3RhdHVzIGNvZGUgMnh4KVxyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7IC8vIFBhcnNlIHJlc3BvbnNlIGJvZHkgYXMgSlNPTlxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEhhbmRsZSBlcnJvciByZXNwb25zZXMgKHN0YXR1cyBjb2RlcyBvdGhlciB0aGFuIDJ4eClcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKS50aGVuKChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yLm1lc3NhZ2UpOyAvLyBUaHJvdyBhbiBlcnJvciB3aXRoIGVycm9yIG1lc3NhZ2VcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIC8vIEhhbmRsZSBzdWNjZXNzZnVsIHJlc3BvbnNlIGRhdGFcclxuICAgICAgY29uc29sZS5sb2coXCJDYXJkIHBvc3RlZCBzdWNjZXNzZnVsbHk6XCIsIGRhdGEpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgLy8gSGFuZGxlIG5ldHdvcmsgZXJyb3JzIG9yIGZhaWxlZCByZXF1ZXN0c1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHBvc3QgY2FyZDpcIiwgZXJyb3IpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIGxpbmsgfSwgaGFuZGxlSW1hZ2VDbGljaywgY2FyZFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTsgLy8gSW5pdGlhbGl6ZSBfZWxlbWVudCBvbmNlXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpOyAvLyBJbml0aWFsaXplIF9saWtlQnV0dG9uIG9uY2VcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTsgLy8gSW5pdGlhbGl6ZSBfY2FyZEltYWdlIG9uY2VcclxuICAgIHRoaXMuX3RyYXNoQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoLWJ1dHRvblwiKTsgLy8gSW5pdGlhbGl6ZSBfdHJhc2hCdXR0b24gb25jZVxyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7IC8vIENhbGwgX3NldEV2ZW50TGlzdGVuZXJzIG9uY2VcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2UpO1xyXG4gICAgdGhpcy5fdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2RlbGV0ZUNhcmQoKSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lIH0pXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2UgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfTtcclxuXHJcbiAgX2RlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHt0aGlzLl9uYW1lfWA7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vIENsb3NlIHRoZSBwb3B1cCB3aGVuIHVzZXJzIGNsaWNrIG9uIHRoZSBzaGFkZWQgYXJlYSBvdXRzaWRlIHRoZSBtb2RhbFxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gZXZlbnQuY3VycmVudFRhcmdldCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuXHJcbiAgICB0aGlzLl9mb3JtSW5wdXRzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gIH1cclxuXHJcbiAgLy8gQ29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIGFuZCByZXR1cm5zIHRoZSBkYXRhIGFzIGFuIG9iamVjdFxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIC8vIE1ha2UgYSBpbnB1dCBkYXRhIG9iamVjdFxyXG4gICAgY29uc3QgaW5wdXRPYmplY3QgPSB7fTtcclxuICAgIC8vIE5hbWUgZWFjaCBpbnB1dCBieSBpdHMgdmFsdWVcclxuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRPYmplY3RbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgLy8gUmV0dXJuIHRoZSBkYXRhIGFzIGFuIG9iamVjdFxyXG4gICAgcmV0dXJuIGlucHV0T2JqZWN0O1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBBZGQgdGhlICdjbGljaycgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsb3NlIGljb25cclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSAnc3VibWl0JyBldmVudCBoYW5kbGVyIHRvIHRoZSBmb3JtXHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIC8vIEdlbmVyYXRlIHRoZSBpZCBmb3IgZXJyb3IgZm9yIHRoZSB0YXJnZXQgZWxlbWVudFxyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgLy8gQWRkIHRoZSBpbnB1dCBlcnJvciBjbGFzcyB0byB0aGUgZWxlbWVudCdzIGNsYXNzIGxpc3RcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAvLyBDaGFuZ2UgdGhlIHRleHQgY29udGVudCB0byB0aGUgZXJyb3IgbWVzc2FnZVxyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIC8vIEFkZCB0aGUgZXJyb3IgY2xhc3MgdG8gdGhlIGVycm9yIG1lc3NhZ2UncyBjbGFzcyBsaXN0XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAvLyBHZW5lcmF0ZSB0aGUgaWQgZm9yIGVycm9yIGZvciB0aGUgdGFyZ2V0IGVsZW1lbnRcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBBZGQgdGhlIGlucHV0IGVycm9yIGNsYXNzIHRvIHRoZSBlbGVtZW50J3MgY2xhc3MgbGlzdFxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuXHJcbiAgICAvLyBDbGVhciB0aGUgZXJyb3IgbWVzc2FnZSBmcm9tIHRoZSB0ZXh0IGNvbnRlbnRcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG5cclxuICAgIC8vIEFkZCB0aGUgZXJyb3IgY2xhc3MgdG8gdGhlIGVycm9yIG1lc3NhZ2UncyBjbGFzcyBsaXN0XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICAvLyBEaXNhYmxlIGZvcm0gYnV0dG9uXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG5cclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICAvLyBFbmFibGUgZm9ybSBidXR0b25cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8vIFNob3cgb3IgaGlkZSBpbnB1dCBlcnJvcnMgYmFzZWQgb24gdGhlIGN1cnJlbnQgaW5wdXQgZWxlbWVudCdzIHZhbGlkaXR5XHJcbiAgX3RvZ2dsZUlucHV0U3RhdGUoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAvLyBJZiBpbnB1dCBlbGVtZW50IGlzIGludmFsaWQsIHNob3cgaW5wdXQgZXJyb3IgbWVzc2FnZVxyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gT3RoZXJ3aXNlLCBoaWRlIGlucHV0IGVycm9yIG1lc3NhZ2VcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGlmIHRoZSBpbnB1dCBlbGVtZW50IGlzIGludmFsaWRcclxuICBfY2hlY2tWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gIH1cclxuXHJcbiAgLy8gQ2hlY2sgaWYgYW55IGVsZW1lbnQgaW4gdGhlIGlucHV0IGxpc3QgaXMgaW52YWxpZFxyXG5cclxuICBfaGFzSW52YWxpZElucHV0ID0gKCkgPT5cclxuICAgIEFycmF5LmZyb20odGhpcy5faW5wdXRMaXN0KS5zb21lKHRoaXMuX2NoZWNrVmFsaWRpdHkpO1xyXG5cclxuICAvLyBUb2dnbGUgYnV0dG9uIGRlcGVuZGluZyBvbiB0aGUgaW5wdXQncyB2YWxpZGl0eVxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIC8vIElmIHRoZSBpbnB1dCBpcyB2YWxpZCwgZGlzYWJsZSB0aGUgYnV0dG9uXHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBPdGhlcndpc2UsIGVuYWJsZSB0aGUgYnV0dG9uXHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gU2V0IGV2ZW50IGxpc3RlbmVycyBmb3IgZm9ybSBlbGVtZW50cyBiYXNlZCBvbiB0aGUgdXNlciBpbnB1dHMnIHZhbGlkaXR5XHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gRGlzYWJsZSBidXR0b25cclxuICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG5cclxuICAgIC8vIExpc3RlbiBmb3IgdGhlIFwidHlwZVwiIGV2ZW50IG9uIGVhY2ggaW5wdXRcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRTdGF0ZShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBWYWxpZGF0ZSBmb3JtXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgLy8gUHJldmVudCB0aGUgZm9ybSdzIGRlZmF1bHQgYmVoYXZpb3VyXHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBTZXQgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgLy8gUmVzZXQgc3VibWl0IGJ1dHRvblxyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICAvLyBDbGVhciBlcnJvciBtZXNzYWdlc1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBBcGkgZnJvbSBcIi4uL0FQSS9BcGkuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgdmFsaWRhdGlvblNldHRpbmdzLCBmb3JtU2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29udGFudHMuanNcIjtcclxuXHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuXHJcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvblwiKTtcclxuY29uc3QgbW9kYWxJbnB1dFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5jb25zdCBtb2RhbElucHV0U3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtc3VidGl0bGUtaW5wdXRcIik7XHJcbmNvbnN0IGFkZENhcmRCdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2NhcmQtYnV0dG9uXCIpO1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImZvcm1BZGRDYXJkXCJdO1xyXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZUZvcm1cIl07XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI1OWQ1MGE3ZC01Y2JjLTQxNDEtOTJjYy1kNGExZTE4MjE5MzBcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRm9ybSBWYWxpZGF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbi8vIENyZWF0ZSBhIGZvcm0gdmFsaWRhdG9ycyBvYmplY3RcclxuY29uc3QgZm9ybVZhbGlkYXRvciA9IHt9O1xyXG5cclxuLy8gQ3JlYXRlIHZhbGlkYXRvciBpbnN0YW5jZXMgZm9yIGFsbCBmb3Jtc1xyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25TZXR0aW5ncykgPT4ge1xyXG4gIC8vIENyZWF0ZSBhbiBhcnJheSBvZiBhbGwgZm9ybXNcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25TZXR0aW5ncy5tb2RhbFNlbGVjdG9yKVxyXG4gICk7XHJcblxyXG4gIC8vIENyZWF0ZSBhIHZhbGlkYXRvciBmb3IgZWFjaCBmb3JtXHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIC8vIENyZWF0ZSBhIHZhbGlkYXRvciBpbnN0YW5jZSBmb3IgdGhlIGN1cnJlbnQgaW5zdGFuY2VcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZm9ybUVsZW1lbnQpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG4gICAgLy8gU3RvcmUgdGhlIGN1cnJlbnQgZm9ybSB2YWxpZGF0b3IgaW4gdGhlIHZhbGlkYXRvcnMgb2JqZWN0XHJcbiAgICBmb3JtVmFsaWRhdG9yW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuXHJcbiAgICAvLyBFbmFibGUgdmFsaWRhdGlvbiBmb3IgdGhlIGN1cnJlbnQgZm9ybVxyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uU2V0dGluZ3MpO1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBvcHVwIEltYWdlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLy8gQ3JlYXRlIGltYWdlIHBvcHVwIGluc3RhbmNlXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoZm9ybVNldHRpbmdzLm1vZGFsSW1hZ2UpO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhcmQgU2VjdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgZGF0YSxcclxuICAgIChpbWFnZURhdGEpID0+IHtcclxuICAgICAgaW1hZ2VQb3B1cC5vcGVuKGltYWdlRGF0YSk7XHJcbiAgICB9LFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XHJcbn1cclxubGV0IGNhcmRTZWN0aW9uO1xyXG5cclxuYXBpXHJcbiAgLmdldEluaXRpYWxDYXJkcygpXHJcbiAgLnRoZW4oKGNhcmRzKSA9PiB7XHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0ocmVuZGVyQ2FyZChjYXJkRGF0YSkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIFwiLmNhcmRzXCJcclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBpbml0aWFsIGNhcmRzOlwiLCBlcnIpO1xyXG4gIH0pO1xyXG5cclxuLy8gfVxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZGQgQ3JhZCAgRm9ybSAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLy8gQ3JlYXRlIHRoZSBhZGQgZm9ybSBpbnN0YW5jZVxyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShmb3JtU2V0dGluZ3MubW9kYWxBZGRDYXJkLCAoZGF0YSkgPT4ge1xyXG4gIC8vIENyZWF0ZSBhIG5ldyBjYXJkXHJcbiAgY29uc3QgbmV3Q2FyZCA9IHJlbmRlckNhcmQoZGF0YSk7XHJcbiAgLy8gQ2xvc2UgdGhlIGFkZCBmb3JtXHJcbiAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgLy8gQWRkIHRoZSBuZXcgY2FyZCB0byB0aGUgc2VjdGlvblxyXG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZCk7XHJcbiAgZm9ybVZhbGlkYXRvclthZGRDYXJkRm9ybS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5kaXNhYmxlQnV0dG9uKCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gb3BlbkNhcmRGb3JtKCkge1xyXG4gIC8vIE9wZW4gdGhlIGFkZCBjYXJkIGZvcm1cclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG59XHJcbi8vIE9wZW4gdGhlIG1vZGFsIHdoZW4gdXNlcnMgY2xpY2sgb24gdGhlIGFkZCBidXR0b25cclxuYWRkQ2FyZEJ1dC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG9wZW5DYXJkRm9ybSgpO1xyXG59KTtcclxuXHJcbi8vIFNldCBhZGQgZm9ybSBldmVudCBsaXN0ZW5lcnNcclxuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlIEluZm9ybWF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vLyBDcmVhdGUgdGhlIHVzZXIgaW5mbyBpbnN0YW5jZVxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcclxuICBmb3JtU2V0dGluZ3MucHJvZmlsZU5hbWUsXHJcbiAgZm9ybVNldHRpbmdzLnByb2ZpbGVTdWJ0aXRsZVxyXG4pO1xyXG4vLyBDcmVhdGUgdGhlIGVkaXQgZm9ybSBpbnN0YW5jZVxyXG5jb25zdCBwcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBmb3JtU2V0dGluZ3MubW9kYWxQcm9maWxlLFxyXG4gICh7IG5hbWUsIHN1YnRpdGxlIH0pID0+IHtcclxuICAgIC8vIEFkZCB0aGUgZm9ybSdzIGlucHV0IHRvIHRoZSBwcm9maWxlIHNlY3Rpb25cclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKG5hbWUsIHN1YnRpdGxlKTtcclxuXHJcbiAgICAvLyBDbG9zZSB0aGUgZWRpdCBmb3JtXHJcbiAgICBwcm9maWxlUG9wdXAuY2xvc2UoKTtcclxuICB9XHJcbik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFZGl0IEZvcm0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLy8gRnVuY3Rpb24gdG8gb3BlbiB0aGUgZWRpdCBtb2RhbCBhbmQgcG9wdWxhdGUgZm9ybSBmaWVsZHMgd2l0aCBwcm9maWxlIGluZm9cclxuZnVuY3Rpb24gb3BlbkVkaXRGb3JtKCkge1xyXG4gIGNvbnN0IHByb2ZpbGVJbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBtb2RhbElucHV0VGl0bGUudmFsdWUgPSBwcm9maWxlSW5mby5uYW1lO1xyXG4gIG1vZGFsSW5wdXRTdWJ0aXRsZS52YWx1ZSA9IHByb2ZpbGVJbmZvLnN1YnRpdGxlO1xyXG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGRpc2FibGUgYnV0dG9ucyBhbmQgcmVzZXQgdmFsaWRhdGlvblxyXG5mdW5jdGlvbiByZXNldFByb2ZpbGVGb3JtKCkge1xyXG4gIGNvbnN0IHByb2ZpbGVWYWxpZGF0b3IgPSBmb3JtVmFsaWRhdG9yW3Byb2ZpbGVGb3JtLmdldEF0dHJpYnV0ZShcIm5hbWVcIildO1xyXG4gIHByb2ZpbGVWYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgcHJvZmlsZVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XHJcbn1cclxuXHJcbi8vIEV2ZW50IGxpc3RlbmVyIGZvciBlZGl0IGJ1dHRvbiBjbGlja1xyXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3BlbkVkaXRGb3JtKCk7XHJcbiAgcmVzZXRQcm9maWxlRm9ybSgpO1xyXG59KTtcclxuXHJcbi8vIFNldCBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBwcm9maWxlIHBvcHVwIG1vZGFsXHJcbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4iLCJleHBvcnQgY29uc3QgZm9ybVNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBjYXJkVGVtcGxhdGU6IFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICBtb2RhbEFkZENhcmQ6IFwiI21vZGFsQWRkQ2FyZFwiLFxyXG4gIG1vZGFsUHJvZmlsZTogXCIjbW9kYWxFZGl0XCIsXHJcbiAgcHJvZmlsZUZvcm06IFwiI2VkaXRfX3Byb2ZpbGVfX2Zvcm1cIixcclxuICBtb2RhbEltYWdlOiBcIiNwcmV2aWV3X2ltYWdlXCIsXHJcbiAgaW1hZ2VNb2RhbENvbnRhaW5lcjogXCIucHJldmlld19fY29udGFpbmVyXCIsXHJcbiAgaW1hZ2VzOiBcIi5jYXJkXCIsXHJcbiAgY2FyZExpc3Q6IFwiLmNhcmRzX19saXN0XCIsXHJcbiAgcHJvZmlsZU5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgcHJvZmlsZVN1YnRpdGxlOiBcIi5wcm9maWxlX19zdWJ0aXRsZVwiLFxyXG59O1xyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yX3Zpc2libGVcIixcclxuICBtb2RhbFNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG59O1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByZXZpZXdfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByZXZpZXdfX2NhcHRpb25cIik7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgLy8gRGVmaW5lIG9wZW5JbWFnZSBhcyBhIHJlZ3VsYXIgbWV0aG9kXHJcbiAgb3BlbihpbWFnZURhdGEpIHtcclxuICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBpbWFnZURhdGEubmFtZTtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGltYWdlRGF0YS5saW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gYGltYWdlICR7aW1hZ2VEYXRhLm5hbWV9YDtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgc3VidGl0bGVTZWxjdG9yKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHN1YnRpdGxlU2VsY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIHN1YnRpdGxlOiB0aGlzLl9zdWJ0aXRsZS50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhuYW1lLCBzdWJ0aXRsZSkge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9zdWJ0aXRsZS50ZXh0Q29udGVudCA9IHN1YnRpdGxlO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsibmFtZSIsImxpbmsiLCJmb3JFYWNoIiwiY2FyZCIsInBheWxvYWQiLCJvcHRpb25zIiwibWV0aG9kIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsImVycm9yIiwiRXJyb3IiLCJtZXNzYWdlIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJoYW5kbGVJbWFnZUNsaWNrIiwiY2FyZFNlbGVjdG9yIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfZWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsIl9saWtlQnV0dG9uIiwicXVlcnlTZWxlY3RvciIsIl9jYXJkSW1hZ2UiLCJfdHJhc2hCdXR0b24iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2UiLCJfZGVsZXRlQ2FyZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImdldFZpZXciLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJhZGQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJlIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJldmVudCIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9mb3JtSW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRPYmplY3QiLCJpbnB1dCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfaW5wdXRMaXN0IiwiX3N1Ym1pdEJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiX2VuYWJsZUJ1dHRvbiIsIl90b2dnbGVJbnB1dFN0YXRlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja1ZhbGlkaXR5IiwiX2hhc0ludmFsaWRJbnB1dCIsIkFycmF5IiwiZnJvbSIsInNvbWUiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJlbmFibGVWYWxpZGF0aW9uIiwicmVzZXRWYWxpZGF0aW9uIiwiZWRpdEJ1dHRvbiIsIm1vZGFsSW5wdXRUaXRsZSIsIm1vZGFsSW5wdXRTdWJ0aXRsZSIsImFkZENhcmRCdXQiLCJhZGRDYXJkRm9ybSIsImZvcm1zIiwicHJvZmlsZUZvcm0iLCJhcGkiLCJiYXNlVXJsIiwiX2NoZWNrUmVzcG9uc2UiLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJnZXRJbml0aWFsQ2FyZHMiLCJfbG9hZERhdGEiLCJmb3JtVmFsaWRhdG9yIiwidmFsaWRhdGlvblNldHRpbmdzIiwibW9kYWxTZWxlY3RvciIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwiaW1hZ2VQb3B1cCIsIl9pbWFnZSIsIl9jYXB0aW9uIiwiaW1hZ2VEYXRhIiwicmVuZGVyQ2FyZCIsImNhcmRTZWN0aW9uIiwiY2FyZHMiLCJjYXJkRGF0YSIsImVyciIsImFkZENhcmRQb3B1cCIsIm5ld0NhcmQiLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsInN1YnRpdGxlU2VsY3RvciIsIl9zdWJ0aXRsZSIsImdldFVzZXJJbmZvIiwic3VidGl0bGUiLCJzZXRVc2VySW5mbyIsInByb2ZpbGVQb3B1cCIsInByb2ZpbGVJbmZvIiwib3BlbkVkaXRGb3JtIiwicHJvZmlsZVZhbGlkYXRvciIsInJlc2V0UHJvZmlsZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9